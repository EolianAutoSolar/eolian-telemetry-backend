#!/bin/bash

create() {
    sudo ip link add dev can0 type vcan
    sudo ip link add dev can1 type vcan
    sudo ip link add dev can_bridge type vcan
    echo "created virtual can0 can1 can_bridge"
}

setup() {
    sudo ip link set can0 up
    sudo ip link set can1 up
    sudo ip link set can_bridge up
    echo "setup can0 can1 can_bridge"
}

setdown() {
    sudo ip link set can0 down
    sudo ip link set can1 down
    sudo ip link set can_brigde down
    echo "shutdown can0 can1 can_bridge"
}

delete() {
    sudo ip link delete can0
    sudo ip link delete can1
    sudo ip link delete can_bridge
    echo "deleted can0 can1 can_bridge"
}

case $1 in
    "-u")
        create
        setup
        ;;
    "-d")
        setdown
        delete
        ;;
    "*")
        create
        setup
        ;;
esac